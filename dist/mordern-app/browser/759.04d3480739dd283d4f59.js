(self.webpackChunkmodernshop_app=self.webpackChunkmodernshop_app||[]).push([[759],{5759:(t,e,o)=>{"use strict";o.r(e),o.d(e,{DiscountsModule:()=>ct});var i=o(1511),n=o(3722),r=o(5001),a=o(1050),s=o(5994),u=o(7806),c=o(7439),d=o(5980),l=o(6073),m=o(6756),p=o(3691),g=o(7521),f=o(5250),h=o(5109),Z=o(1522),v=o(4786),A=o(7033),q=o(8623),x=o(7898),_=o(689),b=o(3005),N=o(6749),U=o(6828),T=o(84),w=o(5619),y=o(3548),C=o(1572),I=o(9063),D=o(529);let k=(()=>{class t{constructor(t){this.httpClient=t}getAll(t){let e=new I.LE;return t&&(e=e.append("page",t.toString())),this.httpClient.get(D.N.baseAuthUrl+"/discounts/get-all",{params:e})}update(t){return this.httpClient.put(D.N.baseAuthUrl+"/discounts/update/"+t.id,t)}store(t){return this.httpClient.post(D.N.baseAuthUrl+"/discounts/store",t)}dataprovider(){return this.httpClient.get(D.N.baseAuthUrl+"/discounts/dataprovider/",{})}get(t){return this.httpClient.get(D.N.baseAuthUrl+"/discounts/get/"+t,{})}delete(t){return this.httpClient.delete(D.N.baseAuthUrl+"/discounts/delete/"+t,{})}}return t.\u0275fac=function(e){return new(e||t)(C.LFG(I.eN))},t.\u0275prov=C.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Q=o(8394),S=o(8509);function Y(t,e){1&t&&C._UZ(0,"mat-progress-bar",19)}function J(t,e){1&t&&(C.TgZ(0,"th",20),C._uU(1,"#"),C.qZA())}function O(t,e){if(1&t&&(C.TgZ(0,"td",21),C._uU(1),C.qZA()),2&t){const t=e.$implicit;C.xp6(1),C.Oqu(t.id)}}function G(t,e){1&t&&(C.TgZ(0,"th",22),C._uU(1,"Nome"),C.qZA())}function B(t,e){if(1&t&&(C.TgZ(0,"td",21),C._uU(1),C.qZA()),2&t){const t=e.$implicit;C.xp6(1),C.Oqu(t.name)}}function L(t,e){1&t&&(C.TgZ(0,"th",22),C._uU(1,"C\xf3digo"),C.qZA())}function F(t,e){if(1&t&&(C.TgZ(0,"td",21),C._uU(1),C.qZA()),2&t){const t=e.$implicit;C.xp6(1),C.Oqu(t.code)}}function E(t,e){1&t&&(C.TgZ(0,"th",22),C._uU(1,"Valor"),C.qZA())}function H(t,e){if(1&t&&(C.TgZ(0,"td",21),C._uU(1),C.ALo(2,"price"),C.qZA()),2&t){const t=e.$implicit;C.xp6(1),C.Oqu(C.lcZ(2,1,t.value))}}function R(t,e){1&t&&(C.TgZ(0,"th",23),C._uU(1,"A\xe7\xf5es"),C.qZA())}function P(t,e){if(1&t){const t=C.EpF();C.TgZ(0,"td",21),C.TgZ(1,"button",24),C._UZ(2,"i",25),C._uU(3," Editar "),C.qZA(),C.TgZ(4,"button",26),C.NdJ("click",function(){const e=C.CHM(t).$implicit;return C.oxw().deleteConfirm(e)}),C._UZ(5,"i",27),C._uU(6," Remover "),C.qZA(),C.qZA()}if(2&t){const t=e.$implicit;C.xp6(1),C.Q6J("routerLink","edit/"+t.id)}}function W(t,e){1&t&&C._UZ(0,"tr",28)}function $(t,e){1&t&&C._UZ(0,"tr",29)}let j=(()=>{class t{constructor(t,e){this.discountService=t,this.alertService=e,this.displayedColumns=["id","name","code","value","actions"],this.loading=!0,this.page=0}ngOnInit(){this.getAll()}getAll(){this.loading=!0,this.discountService.getAll(this.page+1).subscribe(t=>{this.dataSource=t.data,this.total=t.total}).add(()=>this.loading=!1)}delete(t){this.loading=!0,this.discountService.delete(t.id).subscribe(t=>{this.getAll(),this.alertService.toast(t.message)}).add(()=>this.loading=!1)}pageChange(t){this.page=t.pageIndex,this.getAll()}deleteConfirm(t){this.alertService.confirm("Deseja remover o registro?","Remover").subscribe(e=>{e&&this.delete(t)})}}return t.\u0275fac=function(e){return new(e||t)(C.Y36(k),C.Y36(Q.c))},t.\u0275cmp=C.Xpm({type:t,selectors:[["app-discounts"]],decls:27,vars:6,consts:[["class","progress","mode","indeterminate",4,"ngIf"],["fxLayout","column"],["fxLayoutAlign","space-between center"],[1,"margin-right"],["color","primary","mat-flat-button","","routerLink","add"],[1,"mdi","mdi-plus"],["fxFlex","","mat-table","","matSort","","matSortActive","id","matSortDisableClear","","matSortDirection","desc",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","width","50px",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","code"],["matColumnDef","value"],["matColumnDef","actions","stickyEnd",""],["mat-header-cell","","class","actions",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["pageSize","10",3,"pageIndex","length","page"],["mode","indeterminate",1,"progress"],["mat-header-cell","","width","50px"],["mat-cell",""],["mat-header-cell",""],["mat-header-cell","",1,"actions"],["mat-button","","color","primary",3,"routerLink"],[1,"mdi","mdi-pencil"],["mat-button","","color","warn",3,"click"],[1,"mdi","mdi-close"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(C.YNc(0,Y,1,0,"mat-progress-bar",0),C.TgZ(1,"div",1),C.TgZ(2,"div",2),C.TgZ(3,"h1",3),C._uU(4,"Cupons de Desconto"),C.qZA(),C.TgZ(5,"button",4),C._UZ(6,"i",5),C._uU(7," Adicionar "),C.qZA(),C.qZA(),C.TgZ(8,"table",6),C.ynx(9,7),C.YNc(10,J,2,0,"th",8),C.YNc(11,O,2,1,"td",9),C.BQk(),C.ynx(12,10),C.YNc(13,G,2,0,"th",11),C.YNc(14,B,2,1,"td",9),C.BQk(),C.ynx(15,12),C.YNc(16,L,2,0,"th",11),C.YNc(17,F,2,1,"td",9),C.BQk(),C.ynx(18,13),C.YNc(19,E,2,0,"th",11),C.YNc(20,H,3,3,"td",9),C.BQk(),C.ynx(21,14),C.YNc(22,R,2,0,"th",15),C.YNc(23,P,7,1,"td",9),C.BQk(),C.YNc(24,W,1,0,"tr",16),C.YNc(25,$,1,0,"tr",17),C.qZA(),C.TgZ(26,"mat-paginator",18),C.NdJ("page",function(t){return e.pageChange(t)}),C.qZA(),C.qZA()),2&t&&(C.Q6J("ngIf",e.loading),C.xp6(8),C.Q6J("dataSource",e.dataSource),C.xp6(16),C.Q6J("matHeaderRowDef",e.displayedColumns),C.xp6(1),C.Q6J("matRowDefColumns",e.displayedColumns),C.xp6(1),C.Q6J("pageIndex",e.page)("length",e.total))},directives:[i.O5,n.xw,n.Wh,d.lW,y.rH,A.BZ,n.yH,q.YE,A.w1,A.fO,A.Dz,A.as,A.nj,b.NW,s.pW,A.ge,A.ev,A.XQ,A.Gk],pipes:[S.d],styles:[""]}),t})();var z=o(6283),M=o(388);function X(t,e){1&t&&C._UZ(0,"mat-progress-bar",13)}function V(t,e){1&t&&(C.ynx(0),C.TgZ(1,"mat-form-field",6),C.TgZ(2,"mat-label"),C._uU(3,"C\xf3digo"),C.qZA(),C._UZ(4,"input",14),C.qZA(),C.BQk())}const K=function(){return{prefix:"R$ ",thousands:".",decimal:","}};function tt(t,e){1&t&&(C.ynx(0),C.TgZ(1,"mat-form-field",15),C.TgZ(2,"mat-label"),C._uU(3,"Desconto"),C.qZA(),C._UZ(4,"input",16),C.qZA(),C.BQk()),2&t&&(C.xp6(4),C.Q6J("options",C.DdM(1,K)))}function et(t,e){1&t&&(C.ynx(0),C.TgZ(1,"mat-form-field",15),C.TgZ(2,"mat-label"),C._uU(3,"Desconto"),C.qZA(),C._UZ(4,"input",17),C.qZA(),C.BQk())}function ot(t,e){if(1&t&&(C.TgZ(0,"mat-option",29),C._uU(1),C.qZA()),2&t){const t=e.$implicit;C.Q6J("value",t.id),C.xp6(1),C.Oqu(t.name)}}function it(t,e){if(1&t){const t=C.EpF();C.ynx(0,21),C.TgZ(1,"mat-form-field",6),C.TgZ(2,"mat-label"),C._uU(3,"Op\xe7\xe3o"),C.qZA(),C.TgZ(4,"mat-select",22),C.YNc(5,ot,2,2,"mat-option",23),C.qZA(),C.qZA(),C.TgZ(6,"div",24),C.TgZ(7,"mat-form-field",15),C.TgZ(8,"mat-label"),C._uU(9,"Produtos m\xednimos"),C.qZA(),C._UZ(10,"input",25),C.qZA(),C.TgZ(11,"mat-form-field",15),C.TgZ(12,"mat-label"),C._uU(13,"Produtos m\xe1ximos"),C.qZA(),C._UZ(14,"input",26),C.qZA(),C.qZA(),C.TgZ(15,"mat-form-field",15),C.TgZ(16,"mat-label"),C._uU(17,"Porcentagem de desconto"),C.qZA(),C._UZ(18,"input",17),C.qZA(),C.TgZ(19,"button",27),C.NdJ("click",function(){const e=C.CHM(t).index;return C.oxw(2).removeDiscount(e)}),C._UZ(20,"i",28),C._uU(21," Remover desconto "),C.qZA(),C.BQk()}if(2&t){const t=e.index,o=C.oxw(2);C.Q6J("formGroup",o.discountOptions.controls[t]),C.xp6(5),C.Q6J("ngForOf",o.options)}}function nt(t,e){if(1&t){const t=C.EpF();C.ynx(0),C.TgZ(1,"div",18),C.TgZ(2,"button",19),C.NdJ("click",function(){return C.CHM(t),C.oxw().addDiscount()}),C._UZ(3,"i",3),C._uU(4," Adicionar Desconto "),C.qZA(),C.YNc(5,it,22,2,"ng-container",20),C.qZA(),C.BQk()}if(2&t){const t=C.oxw();C.xp6(5),C.Q6J("ngForOf",t.discountOptions.controls)}}let rt=(()=>{class t{constructor(t=null,e,o,i,n){this.formBuilder=t,this.router=e,this.activatedRoute=o,this.alertService=i,this.discountService=n,this.id=null,this.formGroup=new l.cw({id:new l.NI,name:new l.NI("",[l.kI.required,l.kI.maxLength(255)]),code:new l.NI,type:new l.NI("percentage"),value:new l.NI,discount_options:new l.Oe([])})}get discountOptions(){return this.formGroup.get("discount_options")}ngOnInit(){this.id=this.activatedRoute.snapshot.params.id,this.id&&this.get(),this.dataprovider()}dataprovider(){this.loading=!0,this.discountService.dataprovider().subscribe(t=>{this.options=t.options}).add(()=>this.loading=!1)}submit(){this.loading||(this.id?this.update():this.store())}store(){this.loading=!0,this.discountService.store(this.formGroup.value).subscribe(t=>{this.router.navigate(["/","auth","discounts"]),this.alertService.toast(t.message)},t=>{this.alertService.treatError(t)}).add(()=>this.loading=!1)}update(){this.loading=!0,this.discountService.update(this.formGroup.value).subscribe(t=>{this.router.navigate(["/","auth","discounts"]),this.alertService.toast(t.message)},t=>{this.alertService.treatError(t)}).add(()=>this.loading=!1)}get(){this.loading=!0,this.discountService.get(this.id).subscribe(t=>{var e;this.formGroup.patchValue(t),null===(e=t.discount_options)||void 0===e||e.forEach(t=>this.addDiscount(t))}).add(()=>this.loading=!1)}addDiscount(t){this.discountOptions.push(new l.cw({id:new l.NI(null==t?void 0:t.id),option_id:new l.NI(null==t?void 0:t.option_id),min_products:new l.NI(null==t?void 0:t.min_products),max_products:new l.NI(null==t?void 0:t.max_products),value:new l.NI(null==t?void 0:t.value)}))}removeDiscount(t){this.discountOptions.removeAt(t)}}return t.\u0275fac=function(e){return new(e||t)(C.Y36(l.qu),C.Y36(y.F0),C.Y36(y.gz),C.Y36(Q.c),C.Y36(k))},t.\u0275cmp=C.Xpm({type:t,selectors:[["app-add-edit"]],decls:27,vars:8,consts:[["class","progress","mode","indeterminate",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between start"],["color","primary","mat-flat-button","",3,"click"],[1,"mdi","mdi-plus"],[1,"common-form","padding",3,"formGroup","submit"],["fxLayout","column",1,"common-form-max"],["appearance","outline"],["matInput","","required","","formControlName","name"],["formControlName","type"],["value","percentage"],["value","value"],["value","programmatic"],[4,"ngIf"],["mode","indeterminate",1,"progress"],["matInput","","required","","formControlName","code"],["fxFlex","","appearance","outline"],["currencyMask","","matInput","","required","","formControlName","value",3,"options"],["type","number","matInput","","required","","formControlName","value"],["formArrayName","discount_options","fxLayout","column"],["mat-button","","color","primary","type","button",3,"click"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup"],["formControlName","option_id"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutGap","15px"],["type","number","matInput","","required","","formControlName","min_products"],["type","number","matInput","","required","","formControlName","max_products"],["mat-button","","color","warn","type","button",3,"click"],[1,"mdi","mdi-trash-can"],[3,"value"]],template:function(t,e){1&t&&(C.YNc(0,X,1,0,"mat-progress-bar",0),C.TgZ(1,"div",1),C.TgZ(2,"h1"),C._uU(3),C.qZA(),C.TgZ(4,"button",2),C.NdJ("click",function(){return e.submit()}),C._UZ(5,"i",3),C._uU(6),C.qZA(),C.qZA(),C.TgZ(7,"form",4),C.NdJ("submit",function(){return e.submit()}),C.TgZ(8,"div",5),C.TgZ(9,"mat-form-field",6),C.TgZ(10,"mat-label"),C._uU(11,"Nome do Desconto"),C.qZA(),C._UZ(12,"input",7),C.qZA(),C.TgZ(13,"mat-form-field",6),C.TgZ(14,"mat-label"),C._uU(15,"Tipo"),C.qZA(),C.TgZ(16,"mat-select",8),C.TgZ(17,"mat-option",9),C._uU(18,"Porcentagem"),C.qZA(),C.TgZ(19,"mat-option",10),C._uU(20,"Valor"),C.qZA(),C.TgZ(21,"mat-option",11),C._uU(22,"Program\xe1tica"),C.qZA(),C.qZA(),C.qZA(),C.YNc(23,V,5,0,"ng-container",12),C.YNc(24,tt,5,2,"ng-container",12),C.YNc(25,et,5,0,"ng-container",12),C.YNc(26,nt,6,1,"ng-container",12),C.qZA(),C.qZA()),2&t&&(C.Q6J("ngIf",e.loading),C.xp6(3),C.hij("",e.id?"Editar":"Adicionar"," Desconto"),C.xp6(3),C.hij(" ",e.id?"Salvar edi\xe7\xe3o":"Adicionar"," "),C.xp6(1),C.Q6J("formGroup",e.formGroup),C.xp6(16),C.Q6J("ngIf","programmatic"!==e.formGroup.value.type),C.xp6(1),C.Q6J("ngIf","value"===e.formGroup.value.type),C.xp6(1),C.Q6J("ngIf","percentage"===e.formGroup.value.type),C.xp6(1),C.Q6J("ngIf","programmatic"===e.formGroup.value.type))},directives:[i.O5,n.xw,n.Wh,d.lW,l._Y,l.JL,l.sg,z.KE,z.hX,m.Nt,l.Fj,l.Q7,l.JJ,l.u,v.gD,Z.ey,s.pW,n.yH,M.g1,l.wV,l.CE,i.sg,n.SQ],styles:[".list[_ngcontent-%COMP%]{min-width:220px}"]}),t})();const at=[{path:"",component:j},{path:"add",component:rt},{path:"edit/:id",component:rt}];let st=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=C.oAB({type:t}),t.\u0275inj=C.cJS({imports:[[y.Bz.forChild(at)],y.Bz]}),t})();var ut=o(1575);let ct=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=C.oAB({type:t}),t.\u0275inj=C.cJS({imports:[[i.ez,st,n.ae,r.To,a.g,s.Cv,u.Cq,c.QW,d.ot,l.UX,m.c,p.Ps,g.rP,f.ie,h.Nh,Z.Ng,v.LD,A.p0,q.JX,x.f,_.w,b.TU,N.yI,U.AV,T.Bb,w.Co,M.Ud,ut.n]]}),t})()}}]);